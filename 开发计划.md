# AI Note 最小功能版本开发计划

## 项目概述

AI Note 是一个智能台账管理系统，支持用户绑定企业、上传台账模板、通过AI辅助生成笔记、并生成标准化台账文档。

### 核心功能
- 🔐 用户认证系统（登录/注册）
- 🏢 企业/租户绑定
- 📄 台账模板管理
- 📝 智能笔记记录
- 🤖 AI大模型集成
- 📊 台账自动生成与下载

### 技术架构
- **前端**：Vue 3 + TypeScript + Pinia + Vue Router
- **移动端**：TDesign Mobile Vue
- **PC端**：TDesign Vue Next
- **构建工具**：Vite
- **样式框架**：Tailwind CSS
- **后端**：已完成用户/租户/企业/权限模块

---

## 项目现状

### ✅ 已完成
1. **基础架构**
   - Vue 3 + TypeScript 项目初始化
   - Vite 构建配置
   - 双端适配方案（PC/移动端路由分离）
   - 基础组件封装（Button、Input、Dialog）

2. **用户认证**
   - 登录/注册功能
   - JWT Token 管理
   - 用户信息存储

3. **服务层架构**
   - HTTP 请求封装
   - AuthService（登录、注册）
   - API 响应处理机制

### 🔄 进行中
- 无

### ❌ 待完成
1. **核心业务功能**
   - 企业绑定管理
   - 台账模板上传与管理
   - 笔记CRUD操作
   - AI模型集成
   - 台账生成与下载

2. **移动端适配**
   - 响应式布局优化
   - 移动端交互优化

---

## 开发计划（一周）

### Day 1-2: 企业管理与模板上传

#### PC端功能清单
- [ ] **企业绑定页面** (`/enterprise`)
  - 企业列表展示
  - 企业切换功能
  - 企业信息展示
- [ ] **模板管理页面** (`/templates`)
  - 模板上传（支持Excel/Word）
  - 模板列表展示
  - 模板预览功能
  - 模板删除功能
- [ ] **OSS服务实现**
  - 文件上传接口
  - 文件下载接口
  - 文件格式验证

#### 移动端功能清单
- [ ] **企业选择页面** (`/mobile/enterprise`)
  - 企业列表
  - 快速切换
- [ ] **模板列表页面** (`/mobile/templates`)
  - 模板查看
  - 模板基本信息展示

#### 技术实现要点
```typescript
// 需要扩展的服务
class EnterpriseService {
  async getUserEnterprises(): Promise<Enterprise[]>
  async bindEnterprise(enterpriseId: string): Promise<void>
}

class TemplateService {
  async uploadTemplate(file: File): Promise<Template>
  async getTemplates(enterpriseId: string): Promise<Template[]>
  async deleteTemplate(templateId: string): Promise<void>
}

class OssService {
  async uploadFile(file: File, type: 'template' | 'attachment'): Promise<string>
  async getFileUrl(fileId: string): Promise<string>
}
```

---

### Day 3-4: 笔记管理与AI集成

#### PC端功能清单
- [ ] **笔记列表页面** (`/notes`)
  - 分页加载
  - 搜索功能
  - 分类筛选
  - 批量操作
- [ ] **笔记编辑器页面** (`/notes/:id`)
  - 富文本编辑
  - Markdown支持
  - 自动保存
  - 附件上传
- [ ] **AI助手集成**
  - 侧边栏对话界面
  - 笔记内容分析
  - 智能填充建议
- [ ] **笔记-模板关联**
  - 选择对应台账模板
  - 标签字段映射

#### 移动端功能清单
- [ ] **笔记列表** (`/mobile/notes`)
  - 卡片式布局
  - 下拉刷新
  - 上拉加载更多
- [ ] **快速记录** (`/mobile/notes/new`)
  - 简化编辑器
  - 语音输入（可选）
  - 图片快速插入
- [ ] **AI对话页面** (`/mobile/ai`)
  - 全屏对话界面
  - 历史记录

#### 技术实现要点
```typescript
// AI服务集成
class AIService {
  async chat(message: string, context?: NoteContext): Promise<AIResponse>
  async extractFields(note: string, template: Template): Promise<FieldMap>
  async suggestContent(template: Template, partialInput: any): Promise<string>
}

// 完善笔记服务
class NoteService {
  async createNote(note: CreateNoteInput): Promise<Note>
  async updateNote(id: string, note: UpdateNoteInput): Promise<Note>
  async getNotes(query: NoteQuery): Promise<NoteList>
  async deleteNote(id: string): Promise<void>
  async searchNotes(keyword: string): Promise<Note[]>
}
```

---

### Day 5: 台账生成与导出

#### PC端功能清单
- [ ] **台账生成页面** (`/logbook`)
  - 模板选择
  - 数据范围选择（日期、笔记筛选）
  - 预览功能
  - 批量生成
- [ ] **导出功能**
  - Excel格式导出
  - PDF格式导出
  - 自定义导出字段

#### 移动端功能清单
- [ ] **台账预览** (`/mobile/logbook`)
  - 移动端优化预览
  - 分享功能
  - 下载管理

#### 技术实现要点
```typescript
// 日志服务实现
class LogService {
  async generateLogbook(templateId: string, noteIds: string[]): Promise<Logbook>
  async previewLogbook(logbookId: string): Promise<PreviewData>
  async exportLogbook(logbookId: string, format: 'excel' | 'pdf'): Promise<Blob>
}
```

---

### Day 6-7: 优化与测试

#### 性能优化
- [ ] **代码分割**
  - 路由懒加载
  - 组件异步加载
- [ ] **数据优化**
  - 虚拟滚动（大量笔记列表）
  - 图片懒加载
  - 请求缓存
- [ ] **移动端优化**
  - 触摸交互优化
  - 滑动手势支持
  - 离线缓存

#### 用户体验优化
- [ ] **Loading状态**
  - 骨架屏
  - 进度条
  - 错误重试
- [ ] **操作反馈**
  - Toast提示
  - 确认对话框
  - 操作撤销

#### 测试与修复
- [ ] **功能测试**
  - 全流程测试
  - 边界情况处理
- [ ] **兼容性测试**
  - 移动端适配
  - 浏览器兼容性
- [ ] **Bug修复**
  - 收集问题
  - 修复优化

---

## 详细页面规划

### PC端路由结构
```
/                    - 首页/仪表板
├── /auth            - 登录注册
├── /enterprise      - 企业管理
│   ├── /           - 企业列表
│   └── /bind       - 绑定新企业
├── /templates       - 模板管理
│   ├── /           - 模板列表
│   ├── /upload     - 上传模板
│   └── /:id        - 模板详情
├── /notes          - 笔记管理
│   ├── /           - 笔记列表
│   ├── /new        - 新建笔记
│   └── /:id        - 编辑笔记
├── /logbook        - 台账管理
│   ├── /           - 生成台账
│   ├── /:id        - 台账预览
│   └── /history    - 历史记录
└── /profile        - 个人设置
```

### 移动端路由结构
```
/mobile             - 移动端首页
├── /auth          - 登录注册
├── /enterprise    - 企业选择
├── /templates     - 模板列表
├── /notes         - 笔记相关
│   ├── /          - 笔记列表
│   ├── /new       - 快速记录
│   └── /:id       - 笔记详情
├── /ai            - AI助手
└── /logbook       - 台账查看
```

---

## 关键组件设计

### 1. 企业选择器组件
```vue
<!-- EnterpriseSelector.vue -->
<template>
  <t-select v-model="selectedEnterprise" placeholder="选择企业">
    <t-option v-for="item in enterprises" :key="item.id" :value="item.id">
      {{ item.name }}
    </t-option>
  </t-select>
</template>
```

### 2. 文件上传组件
```vue
<!-- FileUpload.vue -->
<template>
  <t-upload
    v-model="files"
    action="/api/upload"
    :format="['xls', 'xlsx', 'doc', 'docx']"
    @success="handleSuccess"
  />
</template>
```

### 3. 富文本编辑器组件
```vue
<!-- RichEditor.vue -->
<template>
  <div class="editor-container">
    <quill-editor
      v-model="content"
      :options="editorOptions"
      @change="handleChange"
    />
  </div>
</template>
```

### 4. AI对话组件
```vue
<!-- AIChat.vue -->
<template>
  <div class="ai-chat">
    <div class="messages" ref="messageContainer">
      <div v-for="msg in messages" :key="msg.id" :class="msg.role">
        {{ msg.content }}
      </div>
    </div>
    <div class="input-area">
      <t-input v-model="input" @enter="sendMessage" />
    </div>
  </div>
</template>
```

---

## 数据模型定义

### 核心数据结构
```typescript
// 企业模型
interface Enterprise {
  id: string
  name: string
  code: string
  description?: string
  createTime: Date
}

// 模板模型
interface Template {
  id: string
  name: string
  type: 'excel' | 'word'
  fileId: string
  fields: TemplateField[]
  enterpriseId: string
  createTime: Date
}

// 笔记模型
interface Note {
  id: string
  title: string
  content: string
  templateId?: string
  fieldValues?: Record<string, any>
  attachments: Attachment[]
  tags: string[]
  createTime: Date
  updateTime: Date
}

// 台账模型
interface Logbook {
  id: string
  name: string
  templateId: string
  data: LogbookEntry[]
  status: 'generating' | 'completed' | 'failed'
  createTime: Date
}
```

---

## 风险评估与应对

### 高风险项
1. **文件解析复杂性**
   - 风险：Excel/Word解析可能遇到格式问题
   - 应对：使用成熟库（如SheetJS、docx）
   - 缓解：提供模板下载，统一格式

2. **AI集成稳定性**
   - 风险：AI接口响应时间不稳定
   - 应对：添加超时和重试机制
   - 缓解：本地缓存常用响应

3. **移动端性能**
   - 风险：大量数据渲染导致卡顿
   - 应对：虚拟滚动、分页加载
   - 缓解：数据预加载策略

### 中风险项
1. **浏览器兼容性**
   - 风险：某些浏览器API不支持
   - 应对：Polyfill和兼容性检测

2. **网络异常处理**
   - 风险：用户网络不稳定
   - 应对：离线缓存、断点续传

---

## 资源需求

### 开发资源
- 前端开发：1人
- 测试：0.5人
- 设计支持：按需

### 第三方服务
- AI大模型API：已确定
- 对象存储OSS：需要配置
- 短信服务（可选）：用于验证码

### 开发工具
- Vue DevTools
- Postman（API测试）
- Chrome DevTools
- 移动端调试工具

---

## 成功标准

### MVP功能验收标准
1. ✅ 用户可以成功登录注册
2. ✅ 用户可以绑定/切换企业
3. ✅ 用户可以上传台账模板
4. ✅ 用户可以创建和编辑笔记
5. ✅ AI可以辅助生成笔记内容
6. ✅ 用户可以生成并下载台账
7. ✅ PC端和移动端均可正常使用

### 性能指标
- 首屏加载时间 < 3秒
- 页面切换响应时间 < 500ms
- 文件上传进度实时显示
- AI响应时间 < 10秒

### 兼容性要求
- Chrome 80+
- Safari 13+
- 移动端：iOS 13+、Android 8+

---

## 后续迭代计划

### V1.1 增强功能
- 笔记分享协作
- 台账模板市场
- AI训练定制化
- 数据分析报表

### V1.2 高级功能
- 工作流自动化
- 第三方系统集成
- 移动端离线编辑
- 批量导入导出

---

*文档版本：v1.0*
*更新时间：2024-12-11*